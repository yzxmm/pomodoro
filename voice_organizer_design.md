# 语音素材智能分类助手 (Voice Asset Organizer) 设计文档

## 1. 项目背景与目标
为了满足 [Pomodoro Widget](global_requirements.txt) 对大量语音素材（Start, End, Interval, Random, Holidays 等）的高效管理需求，我们需要一个辅助工具。
该工具旨在解决手动试听、重命名、移动大量录音文件效率低下的问题，通过**自动语音识别 (ASR)** 和 **Mac Finder 风格的层级视图**，实现“所见即所得”的快速归档。

## 2. 核心功能流程
1.  **导入素材库**: 用户选择一个包含未处理录音的源文件夹。
2.  **自动识别**: 软件自动扫描音频文件，调用 ASR 引擎将语音转换为文字，并显示在文件列表中。
3.  **预览与筛选**: 用户点击文件可直接试听，并看到识别出的文本（辅助判断内容）。
4.  **层级拖拽**: 
    - 界面右侧展示目标目录 (`sounds/`) 的完整层级结构（类似 Mac Finder 列视图）。
    - 用户根据识别的文本内容（如“休息一下吧” -> Interval，“生日快乐” -> Holiday/Birthday），将文件直接拖入对应的分类文件夹。

## 3. 界面设计 (UI/UX)
采用 **PyQt6** 构建，主界面分为左右两栏：

### 左侧：待处理区 (Source)
- **列表视图**: 显示文件名、**识别出的文本内容**、时长。
- **功能**: 
    - 支持按识别文本搜索/过滤。
    - 自动播放（可选）：选中即播放。
    - 批量选择。

### 右侧：归档目标区 (Target - Mac Finder Style)
- **列视图 (QColumnView)**: 
    - 完美契合 `sounds/` 文件夹的深层级结构（例如 `holidays` -> `spring_festival` -> `greeting`）。
    - 点击父文件夹，右侧展开子文件夹，清晰展示路径，无需反复进出文件夹。
- **拖放支持**: 接受来自左侧的文件拖拽，自动移动文件。

## 4. 技术选型

### 4.1 语音识别 (ASR)
推荐使用 **OpenAI Whisper** 模型。
- **理由**: 对中文、英文、日文混合语音的识别准确率极高，且能自动处理标点符号，非常适合短句语音的识别。
- **方案**: 
    - **方案 A (推荐 - 本地)**: 使用 `faster-whisper` 库。速度快，无需联网，隐私性好。需要一定的 CPU/GPU 性能。
    - **方案 B (云端)**: 调用 OpenAI API。精度最高，无需本地算力，但需要 API Key 和网络。

### 4.2 GUI 框架
- **PyQt6 / PySide6**: 
    - 强大的 `QColumnView` 控件原生支持 Mac 风格的文件浏览。
    - 也是主项目 (Pomodoro Widget) 可能使用的框架，技术栈统一。

### 4.3 音频处理
- **PyDub / ffmpeg**: 用于音频格式转换（如录制的 wav 转 mp3）或预处理。

## 5. 可行性评估
- **识别精度**: Whisper 对普通话和简单外语的识别非常成熟，完全可以满足“根据内容分类”的需求。
- **文件管理**: `e:\asmr\Pomodoro_Widget\pomodoro_git\sounds` 目录结构清晰，通过程序读取和展示目录树在技术上非常简单。
- **开发成本**: Python 生态中有现成的 ASR 和 GUI 库，核心逻辑代码量在可控范围内 (预计 300-500 行核心代码)。

## 6. 下一步计划
1.  确认是否需要集成到现有项目中，还是作为一个独立的 `tools` 脚本运行。
2.  编写原型：实现一个简单的 PyQt 窗口，左边加载文件并显示假文本，右边显示 `sounds` 目录结构。
3.  接入 Whisper 模型进行实际识别测试。
